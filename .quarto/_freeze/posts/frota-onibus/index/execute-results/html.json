{
  "hash": "c20b42f9745792e37f83b17f87fa9915",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Frota Onibus\"\nformat: html\njupyter: python3\nimage: \"image.png\"\n---\n\n# Frota Onibus\n\nO código desenvolvido tem como objetivo exibir em um mapa interativo, utilizando a biblioteca Folium, todas as paradas da linha de ônibus 6450-10 da SPTrans, além de mostrar a posição atual do veículo em tempo real. A aplicação permite visualizar facilmente o trajeto da linha e acompanhar o deslocamento do ônibus.\n\n::: {#93d81816 .cell execution_count=1}\n``` {.python .cell-code}\nimport os\nimport requests\nfrom dotenv import load_dotenv\nimport folium\n\nload_dotenv(\".env\")\n\ns = requests.Session()\nlogin = s.post(\n    \"http://api.olhovivo.sptrans.com.br/v2.1/Login/Autenticar\",\n    params={\"token\": \"10bf2c6abc762d12fcc19ee949a430a4c813bece71470d7c3e53bd49f9bb1d6e\"}\n)\n\ncodigo_linha = 1 \n\n\nres = s.get(\n    \"http://api.olhovivo.sptrans.com.br/v2.1/Parada/BuscarParadasPorLinha\",\n    params={\"codigoLinha\": codigo_linha}\n)\nparadas = res.json()\n\n\n\nlat0 = paradas[0][\"py\"]\nlon0 = paradas[0][\"px\"]\n\nm = folium.Map(location=[lat0, lon0], zoom_start=14)\n\nfor p in paradas:\n    folium.Marker(\n        location=[p[\"py\"], p[\"px\"]],\n        popup=p[\"np\"],\n        icon=folium.Icon(color=\"blue\", icon=\"info-sign\")\n    ).add_to(m)\n\n\npos = s.get(\n    \"http://api.olhovivo.sptrans.com.br/v2.1/Posicao/Linha\",\n    params={\"codigoLinha\": codigo_linha}\n).json()\n\nveiculos = pos.get(\"vs\", [])\n\n\nfor v in veiculos:\n    folium.Marker(\n        location=[v[\"py\"], v[\"px\"]],\n        popup=f\"Prefixo: {v['p']}\",\n        icon=folium.Icon(color=\"red\", icon=\"bus\")\n    ).add_to(m)\n\nm\n```\n\n::: {.cell-output .cell-output-display execution_count=1}\n```{=html}\n<div style=\"width:100%;\"><div style=\"position:relative;width:100%;height:0;padding-bottom:60%;\"><span style=\"color:#565656\">Make this Notebook Trusted to load map: File -> Trust Notebook</span><iframe srcdoc=\"&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    \n    &lt;meta http-equiv=&quot;content-type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;\n    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://code.jquery.com/jquery-3.7.1.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js&quot;&gt;&lt;/script&gt;\n    &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.js&quot;&gt;&lt;/script&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/leaflet@1.9.3/dist/leaflet.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-glyphicons.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/Leaflet.awesome-markers/2.0.2/leaflet.awesome-markers.css&quot;/&gt;\n    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/python-visualization/folium/folium/templates/leaflet.awesome.rotate.min.css&quot;/&gt;\n    \n            &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,\n                initial-scale=1.0, maximum-scale=1.0, user-scalable=no&quot; /&gt;\n            &lt;style&gt;\n                #map_6d3ce803c150a796b5af1a3930f33c03 {\n                    position: relative;\n                    width: 100.0%;\n                    height: 100.0%;\n                    left: 0.0%;\n                    top: 0.0%;\n                }\n                .leaflet-container { font-size: 1rem; }\n            &lt;/style&gt;\n\n            &lt;style&gt;html, body {\n                width: 100%;\n                height: 100%;\n                margin: 0;\n                padding: 0;\n            }\n            &lt;/style&gt;\n\n            &lt;style&gt;#map {\n                position:absolute;\n                top:0;\n                bottom:0;\n                right:0;\n                left:0;\n                }\n            &lt;/style&gt;\n\n            &lt;script&gt;\n                L_NO_TOUCH = false;\n                L_DISABLE_3D = false;\n            &lt;/script&gt;\n\n        \n&lt;/head&gt;\n&lt;body&gt;\n    \n    \n            &lt;div class=&quot;folium-map&quot; id=&quot;map_6d3ce803c150a796b5af1a3930f33c03&quot; &gt;&lt;/div&gt;\n        \n&lt;/body&gt;\n&lt;script&gt;\n    \n    \n            var map_6d3ce803c150a796b5af1a3930f33c03 = L.map(\n                &quot;map_6d3ce803c150a796b5af1a3930f33c03&quot;,\n                {\n                    center: [-23.651334, -46.757487],\n                    crs: L.CRS.EPSG3857,\n                    ...{\n  &quot;zoom&quot;: 14,\n  &quot;zoomControl&quot;: true,\n  &quot;preferCanvas&quot;: false,\n}\n\n                }\n            );\n\n            \n\n        \n    \n            var tile_layer_119ebe4f78c97ad079e46f5711cb55a5 = L.tileLayer(\n                &quot;https://tile.openstreetmap.org/{z}/{x}/{y}.png&quot;,\n                {\n  &quot;minZoom&quot;: 0,\n  &quot;maxZoom&quot;: 19,\n  &quot;maxNativeZoom&quot;: 19,\n  &quot;noWrap&quot;: false,\n  &quot;attribution&quot;: &quot;\\u0026copy; \\u003ca href=\\&quot;https://www.openstreetmap.org/copyright\\&quot;\\u003eOpenStreetMap\\u003c/a\\u003e contributors&quot;,\n  &quot;subdomains&quot;: &quot;abc&quot;,\n  &quot;detectRetina&quot;: false,\n  &quot;tms&quot;: false,\n  &quot;opacity&quot;: 1,\n}\n\n            );\n        \n    \n            tile_layer_119ebe4f78c97ad079e46f5711cb55a5.addTo(map_6d3ce803c150a796b5af1a3930f33c03);\n        \n    \n            var marker_01ce3fc0027a4f6069fdd8b28a15c5dc = L.marker(\n                [-23.651334, -46.757487],\n                {\n}\n            ).addTo(map_6d3ce803c150a796b5af1a3930f33c03);\n        \n    \n            var icon_362b1d91416c4eeb16e71847c50500b3 = L.AwesomeMarkers.icon(\n                {\n  &quot;markerColor&quot;: &quot;blue&quot;,\n  &quot;iconColor&quot;: &quot;white&quot;,\n  &quot;icon&quot;: &quot;info-sign&quot;,\n  &quot;prefix&quot;: &quot;glyphicon&quot;,\n  &quot;extraClasses&quot;: &quot;fa-rotate-0&quot;,\n}\n            );\n        \n    \n        var popup_be7fa54020047302413ca526ec224044 = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_8d9af779c8c9250858e09bca6568bde2 = $(`&lt;div id=&quot;html_8d9af779c8c9250858e09bca6568bde2&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;PARADA NICOLINO BARRA B/C&lt;/div&gt;`)[0];\n                popup_be7fa54020047302413ca526ec224044.setContent(html_8d9af779c8c9250858e09bca6568bde2);\n            \n        \n\n        marker_01ce3fc0027a4f6069fdd8b28a15c5dc.bindPopup(popup_be7fa54020047302413ca526ec224044)\n        ;\n\n        \n    \n    \n                marker_01ce3fc0027a4f6069fdd8b28a15c5dc.setIcon(icon_362b1d91416c4eeb16e71847c50500b3);\n            \n    \n            var marker_b8abd9052d725e102a4f83d3dfe9be89 = L.marker(\n                [-23.642592, -46.738745],\n                {\n}\n            ).addTo(map_6d3ce803c150a796b5af1a3930f33c03);\n        \n    \n            var icon_1ebf7e77fdd71e8d83a2e826d41bb7f3 = L.AwesomeMarkers.icon(\n                {\n  &quot;markerColor&quot;: &quot;blue&quot;,\n  &quot;iconColor&quot;: &quot;white&quot;,\n  &quot;icon&quot;: &quot;info-sign&quot;,\n  &quot;prefix&quot;: &quot;glyphicon&quot;,\n  &quot;extraClasses&quot;: &quot;fa-rotate-0&quot;,\n}\n            );\n        \n    \n        var popup_56809e15fbe5f78130c484e2294e96df = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_ae9576954bc75fbe3845c585c74d584b = $(`&lt;div id=&quot;html_ae9576954bc75fbe3845c585c74d584b&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;PARADA DAS BELEZAS B/C&lt;/div&gt;`)[0];\n                popup_56809e15fbe5f78130c484e2294e96df.setContent(html_ae9576954bc75fbe3845c585c74d584b);\n            \n        \n\n        marker_b8abd9052d725e102a4f83d3dfe9be89.bindPopup(popup_56809e15fbe5f78130c484e2294e96df)\n        ;\n\n        \n    \n    \n                marker_b8abd9052d725e102a4f83d3dfe9be89.setIcon(icon_1ebf7e77fdd71e8d83a2e826d41bb7f3);\n            \n    \n            var marker_0ab0bf11de1133166ae8ae96915907d6 = L.marker(\n                [-23.649323, -46.752213],\n                {\n}\n            ).addTo(map_6d3ce803c150a796b5af1a3930f33c03);\n        \n    \n            var icon_ed35017a1b09ef5b18d9c3f52c723d90 = L.AwesomeMarkers.icon(\n                {\n  &quot;markerColor&quot;: &quot;blue&quot;,\n  &quot;iconColor&quot;: &quot;white&quot;,\n  &quot;icon&quot;: &quot;info-sign&quot;,\n  &quot;prefix&quot;: &quot;glyphicon&quot;,\n  &quot;extraClasses&quot;: &quot;fa-rotate-0&quot;,\n}\n            );\n        \n    \n        var popup_06b773dde90abddf91c5cb104bfeddc0 = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_15badfb82c32fdbbd1fe965bb98ee725 = $(`&lt;div id=&quot;html_15badfb82c32fdbbd1fe965bb98ee725&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;PARADA AABB B/C&lt;/div&gt;`)[0];\n                popup_06b773dde90abddf91c5cb104bfeddc0.setContent(html_15badfb82c32fdbbd1fe965bb98ee725);\n            \n        \n\n        marker_0ab0bf11de1133166ae8ae96915907d6.bindPopup(popup_06b773dde90abddf91c5cb104bfeddc0)\n        ;\n\n        \n    \n    \n                marker_0ab0bf11de1133166ae8ae96915907d6.setIcon(icon_ed35017a1b09ef5b18d9c3f52c723d90);\n            \n    \n            var marker_df98defd63db1534fe09d88d97dd2e42 = L.marker(\n                [-23.648242, -46.748656],\n                {\n}\n            ).addTo(map_6d3ce803c150a796b5af1a3930f33c03);\n        \n    \n            var icon_fed6de8941dfde9596dd9efc51b78327 = L.AwesomeMarkers.icon(\n                {\n  &quot;markerColor&quot;: &quot;blue&quot;,\n  &quot;iconColor&quot;: &quot;white&quot;,\n  &quot;icon&quot;: &quot;info-sign&quot;,\n  &quot;prefix&quot;: &quot;glyphicon&quot;,\n  &quot;extraClasses&quot;: &quot;fa-rotate-0&quot;,\n}\n            );\n        \n    \n        var popup_4c6de9818c1df8d65d11c81dea5bad80 = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_e1202921b57efb59bd47474af1844d4a = $(`&lt;div id=&quot;html_e1202921b57efb59bd47474af1844d4a&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;PARADA HOSPITAL CAMPO LIMPO B/C&lt;/div&gt;`)[0];\n                popup_4c6de9818c1df8d65d11c81dea5bad80.setContent(html_e1202921b57efb59bd47474af1844d4a);\n            \n        \n\n        marker_df98defd63db1534fe09d88d97dd2e42.bindPopup(popup_4c6de9818c1df8d65d11c81dea5bad80)\n        ;\n\n        \n    \n    \n                marker_df98defd63db1534fe09d88d97dd2e42.setIcon(icon_fed6de8941dfde9596dd9efc51b78327);\n            \n    \n            var marker_6315d5090e075063c0148e1c42025aa4 = L.marker(\n                [-23.645378, -46.746118],\n                {\n}\n            ).addTo(map_6d3ce803c150a796b5af1a3930f33c03);\n        \n    \n            var icon_aca70bf4dea7efcf705e00bca00e9f90 = L.AwesomeMarkers.icon(\n                {\n  &quot;markerColor&quot;: &quot;blue&quot;,\n  &quot;iconColor&quot;: &quot;white&quot;,\n  &quot;icon&quot;: &quot;info-sign&quot;,\n  &quot;prefix&quot;: &quot;glyphicon&quot;,\n  &quot;extraClasses&quot;: &quot;fa-rotate-0&quot;,\n}\n            );\n        \n    \n        var popup_2fc4a58bcef3e0f78e5b9090045c0da2 = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_3baa305086488fff361e5eb64eb462a6 = $(`&lt;div id=&quot;html_3baa305086488fff361e5eb64eb462a6&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;PARADA CÍCERO JOSÉ SARAIVA B/C&lt;/div&gt;`)[0];\n                popup_2fc4a58bcef3e0f78e5b9090045c0da2.setContent(html_3baa305086488fff361e5eb64eb462a6);\n            \n        \n\n        marker_6315d5090e075063c0148e1c42025aa4.bindPopup(popup_2fc4a58bcef3e0f78e5b9090045c0da2)\n        ;\n\n        \n    \n    \n                marker_6315d5090e075063c0148e1c42025aa4.setIcon(icon_aca70bf4dea7efcf705e00bca00e9f90);\n            \n    \n            var marker_74fd3900bb150b9f2114f2c186b2ec60 = L.marker(\n                [-23.644194, -46.734191499999994],\n                {\n}\n            ).addTo(map_6d3ce803c150a796b5af1a3930f33c03);\n        \n    \n            var icon_f7d43a469e627476f3e154381d7cda0a = L.AwesomeMarkers.icon(\n                {\n  &quot;markerColor&quot;: &quot;red&quot;,\n  &quot;iconColor&quot;: &quot;white&quot;,\n  &quot;icon&quot;: &quot;bus&quot;,\n  &quot;prefix&quot;: &quot;glyphicon&quot;,\n  &quot;extraClasses&quot;: &quot;fa-rotate-0&quot;,\n}\n            );\n        \n    \n        var popup_a81e6de2ded535f2a2f7fb03d0f9bd0b = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_eaab7f06dcc66e8f6370587c227823b3 = $(`&lt;div id=&quot;html_eaab7f06dcc66e8f6370587c227823b3&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;Prefixo: 71662&lt;/div&gt;`)[0];\n                popup_a81e6de2ded535f2a2f7fb03d0f9bd0b.setContent(html_eaab7f06dcc66e8f6370587c227823b3);\n            \n        \n\n        marker_74fd3900bb150b9f2114f2c186b2ec60.bindPopup(popup_a81e6de2ded535f2a2f7fb03d0f9bd0b)\n        ;\n\n        \n    \n    \n                marker_74fd3900bb150b9f2114f2c186b2ec60.setIcon(icon_f7d43a469e627476f3e154381d7cda0a);\n            \n    \n            var marker_7a03df5052fd0b3494d04a2ac0e042be = L.marker(\n                [-23.648301, -46.7487645],\n                {\n}\n            ).addTo(map_6d3ce803c150a796b5af1a3930f33c03);\n        \n    \n            var icon_a2f24e39da7955eab052bfff8b4257f7 = L.AwesomeMarkers.icon(\n                {\n  &quot;markerColor&quot;: &quot;red&quot;,\n  &quot;iconColor&quot;: &quot;white&quot;,\n  &quot;icon&quot;: &quot;bus&quot;,\n  &quot;prefix&quot;: &quot;glyphicon&quot;,\n  &quot;extraClasses&quot;: &quot;fa-rotate-0&quot;,\n}\n            );\n        \n    \n        var popup_371b75e99229ac783011298b325261d4 = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_a61a4b73b4b10f0b9e64bdf022c890b6 = $(`&lt;div id=&quot;html_a61a4b73b4b10f0b9e64bdf022c890b6&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;Prefixo: 71174&lt;/div&gt;`)[0];\n                popup_371b75e99229ac783011298b325261d4.setContent(html_a61a4b73b4b10f0b9e64bdf022c890b6);\n            \n        \n\n        marker_7a03df5052fd0b3494d04a2ac0e042be.bindPopup(popup_371b75e99229ac783011298b325261d4)\n        ;\n\n        \n    \n    \n                marker_7a03df5052fd0b3494d04a2ac0e042be.setIcon(icon_a2f24e39da7955eab052bfff8b4257f7);\n            \n    \n            var marker_1e5c7aa347d44def9116e55459411718 = L.marker(\n                [-23.6543285, -46.7630925],\n                {\n}\n            ).addTo(map_6d3ce803c150a796b5af1a3930f33c03);\n        \n    \n            var icon_dd3eabaf7b1a8d493f7dc620bbca6c68 = L.AwesomeMarkers.icon(\n                {\n  &quot;markerColor&quot;: &quot;red&quot;,\n  &quot;iconColor&quot;: &quot;white&quot;,\n  &quot;icon&quot;: &quot;bus&quot;,\n  &quot;prefix&quot;: &quot;glyphicon&quot;,\n  &quot;extraClasses&quot;: &quot;fa-rotate-0&quot;,\n}\n            );\n        \n    \n        var popup_dc8a922392a4c1b265d1e889f14614ce = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_4c11dc1160b158ccba17c2b775fa655a = $(`&lt;div id=&quot;html_4c11dc1160b158ccba17c2b775fa655a&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;Prefixo: 71426&lt;/div&gt;`)[0];\n                popup_dc8a922392a4c1b265d1e889f14614ce.setContent(html_4c11dc1160b158ccba17c2b775fa655a);\n            \n        \n\n        marker_1e5c7aa347d44def9116e55459411718.bindPopup(popup_dc8a922392a4c1b265d1e889f14614ce)\n        ;\n\n        \n    \n    \n                marker_1e5c7aa347d44def9116e55459411718.setIcon(icon_dd3eabaf7b1a8d493f7dc620bbca6c68);\n            \n    \n            var marker_a96c11b8335f41af616e23cf2aa59bbd = L.marker(\n                [-23.581824500000003, -46.666218625],\n                {\n}\n            ).addTo(map_6d3ce803c150a796b5af1a3930f33c03);\n        \n    \n            var icon_a1016aa4b92fbbcecb3931d1712e6217 = L.AwesomeMarkers.icon(\n                {\n  &quot;markerColor&quot;: &quot;red&quot;,\n  &quot;iconColor&quot;: &quot;white&quot;,\n  &quot;icon&quot;: &quot;bus&quot;,\n  &quot;prefix&quot;: &quot;glyphicon&quot;,\n  &quot;extraClasses&quot;: &quot;fa-rotate-0&quot;,\n}\n            );\n        \n    \n        var popup_6d39cd9369038ac064dc23b094e00682 = L.popup({\n  &quot;maxWidth&quot;: &quot;100%&quot;,\n});\n\n        \n            \n                var html_4d867ad5d1360aff70522bc08667b322 = $(`&lt;div id=&quot;html_4d867ad5d1360aff70522bc08667b322&quot; style=&quot;width: 100.0%; height: 100.0%;&quot;&gt;Prefixo: 71743&lt;/div&gt;`)[0];\n                popup_6d39cd9369038ac064dc23b094e00682.setContent(html_4d867ad5d1360aff70522bc08667b322);\n            \n        \n\n        marker_a96c11b8335f41af616e23cf2aa59bbd.bindPopup(popup_6d39cd9369038ac064dc23b094e00682)\n        ;\n\n        \n    \n    \n                marker_a96c11b8335f41af616e23cf2aa59bbd.setIcon(icon_a1016aa4b92fbbcecb3931d1712e6217);\n            \n&lt;/script&gt;\n&lt;/html&gt;\" style=\"position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;\" allowfullscreen webkitallowfullscreen mozallowfullscreen></iframe></div></div>\n```\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}